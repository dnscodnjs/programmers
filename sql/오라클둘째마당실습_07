-- 1번 문제
SELECT DEPTNO, TRUNC(AVG(SAL), 0) AS AVG_SAL, MAX(SAL) AS MAX_SAL, MIN(SAL) AS MIN_SAL, COUNT(DEPTNO) AS CNT
FROM EMP
GROUP BY DEPTNO
ORDER BY DEPTNO DESC;

-- 2번 문제
SELECT JOB, COUNT(JOB)
FROM EMP
GROUP BY JOB
HAVING COUNT(JOB) >= 3
ORDER BY COUNT(JOB) DESC;

-- 3번 문제
SELECT TO_CHAR(HIREDATE, 'YYYY') AS HIRE_YEAR, DEPTNO, COUNT(DEPTNO) AS CNT
FROM EMP
GROUP BY TO_CHAR(HIREDATE, 'YYYY'), DEPTNO;

-- 4번 문제
SELECT NVL2(COMM, 'O', 'X'), COUNT(NVL2(COMM, 'O', 'X')) AS CNT
FROM EMP
GROUP BY NVL2(COMM, 'O', 'X');

-- 5번 문제
SELECT
    DEPTNO,
    TO_CHAR(HIREDATE,'YYYY'),
    COUNT(*),
    MAX(SAL),
    SUM(SAL),
    ROUND(AVG(SAL),10)
FROM EMP
GROUP BY ROLLUP(DEPTNO,TO_CHAR(HIREDATE,'YYYY'));
